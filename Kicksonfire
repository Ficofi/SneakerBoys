# -*- coding: utf-8 -*-
import scrapy
from scrapy.http import Request


class FirespiderSpider(scrapy.Spider):
    name = 'firespider'
    page_number = 2
    allowed_domains = ['kicksonfire.com']
    start_urls = ['https://www.kicksonfire.com/app/upcoming?page=1']

    CUSTOM_PROXY = "http://80.187.140.26:8080"

    def start_request (self):
        for url  in self.start_urls():
            request = scrapy.request(url,callback = self.parse)
            request.meta['proxy'] = self.CUSTOM_PROXY
            yield request

    def parse(self, response):
        shoe_links = response.xpath ('//div/a/@href').extract()[1:None]
        for link in shoe_links:
            yield scrapy.Request(link, callback=self.parse_page, dont_filter=True)


    def parse_page(self, response):
        shoe_name = response.xpath('//div/h2/text()').extract()[0].strip()
        print('Schuh:' + shoe_name)
        yield {'Schuh': shoe_name}


