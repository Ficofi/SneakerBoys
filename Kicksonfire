# -*- coding: utf-8 -*-
import scrapy
from scrapy.http import Request


class kicksSpider(scrapy.Spider):
    name = 'kicks'
    page_number = 2
    allowed_domains = ['kicksonfire.com']
    

    def start_requests (self):
    	urls = ['https://www.kicksonfire.com/app/upcoming?page=1']
    	for i, url in enumerate(urls):
   			yield scrapy.Request("https://www.kicksonfire.com", meta={'cookiejar': i},
        	callback=self.parse)

    def parse(self, response):
        shoe_links = response.xpath ('//div/a/@href').extract()[1:None]
        for link in shoe_links:
            yield scrapy.Request(link, callback=self.parse_page, dont_filter=True)


    def parse_page(self, response):
        shoe_name = response.xpath('//div/h2/text()').extract()[0].strip()
        print('Schuh:' + shoe_name)
        yield {'Schuh': shoe_name}
        return scrapy.Request('shoe_links',
        meta={'cookiejar': response.meta['cookiejar']})
